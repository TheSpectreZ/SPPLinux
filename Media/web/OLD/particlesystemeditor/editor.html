<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - particles - sprites</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        
    <script type="text/javascript" src="./../../Dependencies/jQuery/jquery-3.5.1.js"></script>	
		<script type="text/javascript" src="./../../Dependencies/GoldenLayout/goldenlayout.min.js "></script>		
      
		<link type="text/css" rel="stylesheet" href="goldenlayout-base.css" />
		<link type="text/css" rel="stylesheet" href="goldenlayout-dark-theme.css" />
        
    <style>

    html,
    body {
    height: 100%;
    width: 100%;
    margin: 0;
    }

	  .menuButtons {
		background-color: #1b1b1b;
		color: white;
		margin: 4px;
		
		border: none;
	  }
  
	  .dropdown {
	  	position: relative;
	  	display: inline-block;
	  	font-size: 16px;
	  }
	  .dropdown-content {
	  	display: none;
	  }
	  .dropdown-content {
	  	display: none;
	  	position: absolute;
	  	background-color: #1b1b1b;
	  	min-width: 120px;
	  	box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
	  	z-index: 1000;
	  	color: white;
	  }
	  .dropdown-content a {
	  	color: white;
	  	margin: 4px;
	  	text-decoration: none;
	  	display: block;
	  }
	  .dropdown-content a:hover {
	  	background-color: #000;
	  }
	  .dropdown:hover .dropdown-content {
	  	display: block;
	  }
	  .dropdown:hover .dropbtn {
	  	background-color: #000;
	  }

	  #menuArea {
	  	display: inline-block;
	  	background-color: #000;
	  	width:100%;
	  }

    </style>
	</head>
	<body style="background-color:rgba(0, 0, 0, 0);">
	
	 <div id="menuArea">
	  <div class="dropdown">
		<button class="dropbtn menuButtons">File</button>
		<div class="dropdown-content">
			<a href="javascript:menuCommand('New');">New</a> 
			<a href="javascript:menuCommand('Load');">Load</a>  
			<a href="javascript:menuCommand('Save');">Save</a>  
			<a href="javascript:menuCommand('Exit');">Exit</a> 
		</div>
	  </div>
	  <div class="dropdown">
		<button class="dropbtn menuButtons">Help</button>
		<div class="dropdown-content"> 
			<a href="javascript:window.InvokeNative('HelpClick','GIT');">GIT Repository</a> 
		</div>
	  </div>
	</div>

        <script>
		
		function menuCommand(InValue) {            
            window.InvokeNative("EDITOR", "menuCommand " + InValue );
		}
		
        /*
          // here, core is equal to `import * as core from '@theatre/core`
          const core = Theatre.core
          // here, studio is equal to `import studio from '@theatre/studio`.
          // Note this would be undefined if you're using `core-only.min.js`
          const studio = Theatre.studio

          // only call this if you're using the core-and-studio.js bundle
          studio.initialize()

          const project = core.getProject("Particle Editor")
          const sheet = project.sheet("Layer 0")
          // and so on...
          
          const Layer0Obj = sheet.object('Properties', {
          // Note that the rotation is in radians
          // (full rotation: 2 * Math.PI)
          // `mesh.rotation.x` is a number we're using as an initial value
          velocity: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          rotation: 0,
          scale: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          color: core.types.rgba({ r: 127, g: 127, b: 127, a: 255 }),
        })
        
        const sheet2 = project.sheet("Layer 1")
        
        const Layer1Obj = sheet2.object('Properties', {
          // Note that the rotation is in radians
          // (full rotation: 2 * Math.PI)
          // `mesh.rotation.x` is a number we're using as an initial value
          velocity: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          rotation: 0,
          scale: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          color: core.types.rgba({ r: 127, g: 127, b: 127, a: 255 }),
        })
*/

        var config = {
            settings:{
                hasHeaders: true,
                constrainDragToContainer: true,
                reorderEnabled: true,
                selectionEnabled: false,
                popoutWholeStack: false,
                blockedPopoutsThrowError: false,
                closePopoutsOnUnload: false,
                showPopoutIcon: false,
                showMaximiseIcon: false,
                showCloseIcon: false
            },
            content: [{
                type: 'row',
                content:
                [
                    {
                        type: 'component',
                        componentName: 'Control Panel',
                        width: 50,
                        isClosable: false,
                    },
                    {
                        type: 'component',
                        componentName: 'Viewer',
                        isClosable: false,
                    }
                ]
            }]
        };

        var myLayout = new GoldenLayout( config );
        
        myLayout.registerComponent( 'Control Panel', function( container, componentState ){
            container.getElement().html( "<div id='LeftPane'></div>" );            
            container.getElement().css( "background", "#333" );
        });
        
        if (!String.prototype.format) {
		  String.prototype.format = function() {
			var args = arguments;
			return this.replace(/{(\d+)}/g, function(match, number) { 
			  return typeof args[number] != 'undefined'
				? args[number]
				: match
			  ;
			});
		  };
		}

        myLayout.registerComponent( 'Viewer', function( container, componentState ){	
            container.getElement().html( '<div id="gameView" style="width: 100%; height:100%; "> </div>' );
            
            container.on( 'resize', function()
            {
                var leftPos  = $("#gameView")[0].getBoundingClientRect().left   + $(window)['scrollLeft']();
                var rightPos = $("#gameView")[0].getBoundingClientRect().right  + $(window)['scrollLeft']();
                var topPos   = $("#gameView")[0].getBoundingClientRect().top    + $(window)['scrollTop']();
                var bottomPos= $("#gameView")[0].getBoundingClientRect().bottom + $(window)['scrollTop']();
                
                window.InvokeNative("EDITOR", "GameViewCoords {0} {1} {2} {3}".format(leftPos, rightPos, topPos, bottomPos) );
            });
        });
        
        myLayout.on( 'initialised', function(){
            
                $("#LeftPane").load("control_tab.html");
                
               
        });
            
        myLayout.init();
        
        window.InvokeNative = function(InFuncName, ...theArgs) {				
            if(window.CallNativeWithJSON)
            {
                window.CallNativeWithJSON(JSON.stringify({ func: InFuncName, args: theArgs }));
            }	
            else
            {
                console.log("No Native Invoke: | " + JSON.stringify({ func: 			InFuncName, args: theArgs }))
            }
        }
                
        function ProcessJS(FuncName, ...Args) {	  
            console.log("ProcessJS: " + FuncName + " : " + Args.length);
            // find object
            var fn = window[FuncName];
            // is object a function?
            if (typeof fn === "function") 
            {
                fn.apply(null, Args);
            }
        }	

        if(window.RegisterJS)
        {	
            window.RegisterJS(ProcessJS);		
        }
        
        </script>
	</body>
</html>