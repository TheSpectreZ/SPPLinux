<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Material Editor</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
        
        
        <script type="text/javascript" src="../jQuery/jquery-3.5.1.js"></script>	
        <script src="../tweakpane/tweakpane-3.1.7.min.js"></script>
        <script src="../theatrejs/core-and-studio.js"></script>
		    <script type="text/javascript" src="../GoldenLayout/goldenlayout.min.js"></script>		
		    <link type="text/css" rel="stylesheet" href="../GoldenLayout/goldenlayout-base.css" />
		    <link type="text/css" rel="stylesheet" href="../GoldenLayout/goldenlayout-dark-theme.css" />
        

        <link rel="stylesheet" type="text/css" href="../litegraph.js/css/litegraph.css">
        <script type="text/javascript" src="../litegraph.js/SPPlitegraph.core.js"></script>
        
        <script type="text/javascript" src="../NodeGraph/Base.js"></script> 
        <script type="text/javascript" src="../NodeGraph/Math.js"></script> 
        <script type="text/javascript" src="../NodeGraph/Material.js"></script> 
    <style>

    html,
    body {
      height: 100%;
      width: 100%;
      margin: 0;
    }
    
    </style>
	</head>
	<body>
        <script>
        /*
          // here, core is equal to `import * as core from '@theatre/core`
          const core = Theatre.core
          // here, studio is equal to `import studio from '@theatre/studio`.
          // Note this would be undefined if you're using `core-only.min.js`
          const studio = Theatre.studio

          // only call this if you're using the core-and-studio.js bundle
          studio.initialize()

          const project = core.getProject("Particle Editor")
          const sheet = project.sheet("Layer 0")
          // and so on...
          
          const Layer0Obj = sheet.object('Properties', {
          // Note that the rotation is in radians
          // (full rotation: 2 * Math.PI)
          // `mesh.rotation.x` is a number we're using as an initial value
          velocity: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          rotation: 0,
          scale: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          color: core.types.rgba({ r: 127, g: 127, b: 127, a: 255 }),
        })
        
        const sheet2 = project.sheet("Layer 1")
        
        const Layer1Obj = sheet2.object('Properties', {
          // Note that the rotation is in radians
          // (full rotation: 2 * Math.PI)
          // `mesh.rotation.x` is a number we're using as an initial value
          velocity: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          rotation: 0,
          scale: core.types.compound({
            x: 0,
            y: 0,
            z: 0,
          }),
          color: core.types.rgba({ r: 127, g: 127, b: 127, a: 255 }),
        })
*/

        var config = {
            settings:{
                hasHeaders: true,
                constrainDragToContainer: true,
                reorderEnabled: true,
                selectionEnabled: false,
                popoutWholeStack: false,
                blockedPopoutsThrowError: false,
                closePopoutsOnUnload: false,
                showPopoutIcon: false,
                showMaximiseIcon: false,
                showCloseIcon: false
            },
            content: [{
                type: 'row',
                content:
                [
                    {
                        type: 'component',
                        componentName: 'testComponenta',
                        width: 20,
                        isClosable: false,
                    },
                    {
                        type: 'component',
                        componentName: 'gameViewComp',
                        isClosable: false,
                    }
                ]
            }]
        };

        var myLayout = new GoldenLayout( config );
  
        
        
        myLayout.registerComponent( 'testComponenta', function( container, componentState ){
            container.getElement().html( "<div id='testA'> A </div>" );
            
            
            
        });

        myLayout.registerComponent( 'gameViewComp', function( container, componentState ){	
            container.getElement().html( '<canvas id="gameView" width="1280" height="720" > </canvas>' );
            
            container.on( 'resize', function()
            {
                var leftPos  = $("#gameView")[0].getBoundingClientRect().left   + $(window)['scrollLeft']();
                var rightPos = $("#gameView")[0].getBoundingClientRect().right  + $(window)['scrollLeft']();
                var topPos   = $("#gameView")[0].getBoundingClientRect().top    + $(window)['scrollTop']();
                var bottomPos= $("#gameView")[0].getBoundingClientRect().bottom + $(window)['scrollTop']();
                
                console.log("leftPos:" + leftPos);
                console.log("rightPos:" + rightPos);
                console.log("topPos:" + topPos);
                console.log("bottomPos:" + bottomPos);
                
                var graph = new LGraph();
                var canvas = new LGraphCanvas("#gameView", graph);

                var testnode = LiteGraph.createNode("material/matContext");
                graph.add(testnode);

                var t = LiteGraph.createNode("material/matTexture");
                graph.add(t);

                graph.arrange();

                graph.start();
            });
        });

        
        myLayout.registerComponent( 'testComponent', function( container, componentState ){
            container.getElement().html( "B" );
            
             //container.getElement().css( "background-color", "rgba(0, 0, 0, 0)" );
        });
               
        
        myLayout.on( 'initialised', function(){
            const PARAMS = {
                  factor: 123,
                  title: 'hello',
                  color: '#ff0055',
                };
                
                const pane = new Tweakpane.Pane({
                    container: document.getElementById("testA")
                });

                pane.addInput(PARAMS, 'factor');
                pane.addInput(PARAMS, 'title');
                pane.addInput(PARAMS, 'color');
        });
            
        myLayout.init();
        </script>
	</body>
</html>